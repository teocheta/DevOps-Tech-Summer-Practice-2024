# Lesson8: Comanda top

### Comanda top este de tipul administrativ.

1.**Expicatia comenzii top:**

**top**

Prima linie:

top - 10:37:50 up 11 min,  0 users,  load average: 0.00, 0.08, 0.11

Explicatii:

top - program name

10:37:50 -current hour

up 11 min - uptime. Another words, the time from last start of the system.

0 users - number of active users. Here we can see similar information, like with command who.

**who**

The main purpose of who is to show who is logged in. 

load average: 0.00, 0.08, 0.11

We see here three numbers. They are representing the load average for the system in last 1, 5 and 15 minutes. These shows the average number of processes running and waiting for CPU time.

It is crucial to understand, that these values need to be evaluated very closely with the number of CPUs, Cores, Threads. The number 10 means massive overload when your system has 1 core, but is quite ok when your system has 12 cores. 

**Command: "w"**

This command shows logged users too, but the first line is exactly the same like in top.

A doua linie:

Tasks: 116 total,   1 running, 115 sleeping,   0 stopped,   0 zombie

* total - shows all processes in the system
* running - currently active processes. It means, these processes are using CPU right now
* sleeping - generally - process is waiting for something. It may be I/O operation for example.
* stopped - Stopped processes (for example by ctrl+z)
* zombie - Very important state to understand. It is a process which had finish his job but still has entry in the process table. In simple way, these processes are waiting for exit(). It may happen, when parent process deteriorated somehow. Sometimes we are able to kill zombie (by killing the parrent), but in many cases it will not work.

**total** doesn't repesent all processes. For example, you will not find idle state here.

A treia linie:

%Cpu(s):  0.0 us,  0.0 sy,  0.0 ni,100.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st

A treia linie arata utilizarea CPU-ului, impartita in diferite tipuri.

* us - user - All user processes are combined in this number. So, our sessions too.
* sy - system - processes owned by system (kernel)
* ni - nice - this is important to understand. nice allows us to change the priority of the process. The standard value for processes is 0 , but we can modify it from 19 (lowest) to -20 (highest) priority. This statistic here shows all processes with the niceness set above 0. So, the processes which will be executed by the system, when "systemm will have time for it".
* id - idle 
* wa - iowait - the number repspresents the time (which is a subset of idle time) when the process is waiting for input/output operation. This statistic is very important, because it may show the issue outside the CPU, in other hardware (but not only) components.
* hi - hardware interrupts. These are physical interrrupts from hardware and are handled by CPU itself.
* si - software interrupts. These are generated by software and are handled by kernel.
* st - steal time - very important to understand, especially when we are working on virtualized environment. This number represents the time "stealed" from the virtual machine by hypervisor. Another words, how long our system needs to wait for resources from hypervisor.

Liniile 4 si 5:

MiB Mem :   1983.3 total,    365.4 free,    257.7 used,   1360.2 buff/cache

MiB Swap:   1024.0 total,   1024.0 free,      0.0 used.   1533.1 avail Mem

Liniile 4 si 5 reprezinta informatii despre memorie.
 Prima linie este despre memoria fizica, iar a 2-a linie este despre swap.

* buff/cache is a combine value of buffer memory, used by kernel and cache, memory by page cache. 

* available simply means that the new starting program, application, etc can use max this size of memory for its to be run.

## Lista proceselor
* PID - Process ID number. It is unique number of the process in the system.
* USER - process' owner. The process is started by this user.
* PR - default priority of the process, scheduled by kernel when process was started.
* NI - nice. Shows the value, if nice was performed against the process.
* VIRT - total amount of memory used by the process.
* RES - RAM memory used by process.
* SHR - amount of memory shared with other processes.
* S - process state.
* %CPU - what amount of available CPU is used by the process.
* %MEM - like for CPU, but this value represents memory usage.
* TIME+ - total time of CPU usage by the process.
* COMMAND

2.**Modificarea default view**

Pe langa explicatiile de dinainte, top poate modificca si aspecte vizuale.

CPU si MEMORY LIST:

Daca apasam comanda 1 in top de cateva ori ni se va afisa in linia 3 single cores.

Dacca apasam "t" ni se va schimba modul in care linia de Task uri arata, iar daca apasam "m" ni se modifica vizual sau dispar liniile 4 si 5.

Modify the order in the processes list:

The standard view is by CPU usage.

Let's switch to order by memory usage. In order to do it, press

M .

Now, by pressing

N we will look on the list sorted by PID.

Ok, Let's press

T and now we have order by running time.

Finally we can come back to CPU usage sort, by pressing

P 

Task-uri si thread-uri:

Ca default, procesele din lista contin task-uri. Acestea pot fi schimbate cu threads apasand **H**.

PATHS AND Trees:

Apasand c vedem simple name al comenzii si path-ul complet.

v and V shows the tree of processes, instead simple list.

FILTERING:

Apasand n limitam numarul de thread-uri/procese afisate.

Apasand u putem selecta un user din lista.

REFRESH: se face cu comanda **"s"**

Kill the process: Press k.
Save the changes: press W.
Schimbarile vor fi schimbate in .toprc

3. START WITH NON DEFAULT SETTINGS

* top -o %MEM - run top with processes sorted by memory.
* top -c will show the full paths.
* top -u root will show the processes owned by root user.


